<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="An Introduction to Machine Learning" />
<meta property="og:type" content="book" />
<meta property="og:url" content="https://m-clark.github.io/docs/" />
<meta property="og:image" content="https://m-clark.github.io/docs/img/nineteeneightyR.png" />
<meta property="og:description" content="An introduction to machine learning for applied researchers." />
<meta name="github-repo" content="m-clark/introduction-to-machine-learning/" />


<meta name="date" content="2017-04-21" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="An introduction to machine learning for applied researchers.">

<title>An Introduction to Machine Learning</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<script src="libs/htmlwidgets-0.8/htmlwidgets.js"></script>
<script src="libs/jquery-1.12.4/jquery.min.js"></script>
<script src="libs/datatables-binding-0.2/datatables.js"></script>
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>


<link rel="stylesheet" href="standard_html.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
<link rel="stylesheet" href="mytufte.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#section"></a></li>
<li><a href="00_preface.html#preface">Preface</a></li>
<li class="has-sub"><a href="01_intro.html#introduction">Introduction</a><ul>
<li><a href="01_intro.html#explanation-prediction">Explanation &amp; Prediction</a></li>
<li><a href="01_intro.html#some-terminology">Some Terminology</a></li>
</ul></li>
<li class="has-sub"><a href="02_tools.html#tools">Tools</a><ul>
<li><a href="02_tools.html#the-standard-linear-model">The Standard Linear Model</a></li>
<li><a href="02_tools.html#logistic-regression">Logistic Regression</a></li>
<li class="has-sub"><a href="02_tools.html#expansions-of-those-tools">Expansions of Those Tools</a><ul>
<li><a href="02_tools.html#generalized-linear-models">Generalized Linear Models</a></li>
<li><a href="02_tools.html#generalized-additive-models">Generalized Additive Models</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="03_loss.html#the-loss-function">The Loss Function</a><ul>
<li class="has-sub"><a href="03_loss.html#continuous-outcomes">Continuous Outcomes</a><ul>
<li><a href="03_loss.html#squared-error">Squared Error</a></li>
<li><a href="03_loss.html#absolute-error">Absolute Error</a></li>
<li><a href="03_loss.html#negative-log-likelihood">Negative Log-likelihood</a></li>
<li><a href="03_loss.html#r-example">R Example</a></li>
</ul></li>
<li class="has-sub"><a href="03_loss.html#categorical-outcomes">Categorical Outcomes</a><ul>
<li><a href="03_loss.html#misclassification">Misclassification</a></li>
<li><a href="03_loss.html#binomial-log-likelihood">Binomial log-likelihood</a></li>
<li><a href="03_loss.html#exponential">Exponential</a></li>
<li><a href="03_loss.html#hinge-loss">Hinge Loss</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="04_regularization.html#regularization">Regularization</a><ul>
<li><a href="04_regularization.html#r-example-1">R Example</a></li>
</ul></li>
<li class="has-sub"><a href="05_biasvar.html#bias-variance-tradeoff">Bias-Variance Tradeoff</a><ul>
<li><a href="05_biasvar.html#bias-variance">Bias <em>&amp;</em> Variance</a></li>
<li><a href="05_biasvar.html#the-tradeoff">The Tradeoff</a></li>
<li class="has-sub"><a href="05_biasvar.html#diagnosing-bias-variance-issues-possible-solutions">Diagnosing Bias-Variance Issues <em>&amp;</em> Possible Solutions</a><ul>
<li><a href="05_biasvar.html#worst-case-scenario">Worst Case Scenario</a></li>
<li><a href="05_biasvar.html#high-variance">High Variance</a></li>
<li><a href="05_biasvar.html#high-bias">High Bias</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="06_crossval.html#cross-validation">Cross-Validation</a><ul>
<li><a href="06_crossval.html#adding-another-validation-set">Adding Another Validation Set</a></li>
<li class="has-sub"><a href="06_crossval.html#k-fold-cross-validation">K-fold Cross-Validation</a><ul>
<li><a href="06_crossval.html#leave-one-out-cross-validation">Leave-one-out Cross-Validation</a></li>
</ul></li>
<li><a href="06_crossval.html#bootstrap">Bootstrap</a></li>
<li><a href="06_crossval.html#other-stuff">Other Stuff</a></li>
</ul></li>
<li class="has-sub"><a href="07_models.html#model-assessment-selection">Model Assessment &amp; Selection</a><ul>
<li><a href="07_models.html#beyond-classification-accuracy-other-measures-of-performance">Beyond Classification Accuracy: Other Measures of Performance</a></li>
</ul></li>
<li class="has-sub"><a href="08_overview.html#process-overview">Process Overview</a><ul>
<li class="has-sub"><a href="08_overview.html#data-preparation">Data Preparation</a><ul>
<li><a href="08_overview.html#define-data-and-data-partitions">Define Data and Data Partitions</a></li>
<li><a href="08_overview.html#feature-scaling">Feature Scaling</a></li>
<li><a href="08_overview.html#feature-engineering">Feature Engineering</a></li>
<li><a href="08_overview.html#discretization">Discretization</a></li>
</ul></li>
<li><a href="08_overview.html#model-selection">Model Selection</a></li>
<li><a href="08_overview.html#model-assessment">Model Assessment</a></li>
</ul></li>
<li class="has-sub"><a href="1000_appendix.html#appendix">Appendix</a><ul>
<li><a href="1000_appendix.html#bias-variance-demo">Bias Variance Demo</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="the-loss-function" class="section level1">
<h1>The Loss Function</h1>
<p><span class="newthought">Given a set of predictor variables</span> <span class="math inline">\(X\)</span> and some target <span class="math inline">\(y\)</span>, we look for some function <span class="math inline">\(f(X)\)</span> to make predictions of y from those input variables. We also need a function to penalize errors in prediction- a <span class="emph">loss function</span>, <span class="math inline">\(L(Y, f(X))\)</span>. With a chosen loss function, we then find the model which will minimize loss, generally speaking. We will start with the familiar and note a couple others that might be used.</p>
<div id="continuous-outcomes" class="section level2">
<h2>Continuous Outcomes</h2>
<div id="squared-error" class="section level3">
<h3>Squared Error</h3>
<p>The classic loss function for linear models with continuous response is the squared error loss function, or the residual sum of squares.</p>
<p><span class="math display">\[L(Y, f(X)) = \sum(y-f(X))^2\]</span></p>
</div>
<div id="absolute-error" class="section level3">
<h3>Absolute Error</h3>
<p>For an approach more robust to extreme observations, we might choose absolute rather than squared error as follows. In this case, predictions are a conditional median rather than a conditional mean.</p>
<p><span class="math display">\[L(Y, f(X)) = \sum|(y-f(X))|\]</span></p>
</div>
<div id="negative-log-likelihood" class="section level3">
<h3>Negative Log-likelihood</h3>
<p>We can also think of our usual likelihood methods learned in a standard applied statistics course as incorporating a loss function that is the negative log-likelihood pertaining to the model of interest. If we assume a normal distribution for the response we can note the loss function as:</p>
<p><span class="math display">\[L(Y, f(X)) = n\ln{\sigma} + \sum \frac{1}{2\sigma^2}(y-f(X))^2\]</span></p>
<p>In this case it would converge to the same answer as the squared error/least squares solution.</p>
</div>
<div id="r-example" class="section level3">
<h3>R Example</h3>
<p>The following provides code that one could use with the <span class="func">optim</span> function in R to find estimates of regression coefficients (beta) that minimize the squared error. X is a design matrix of our predictor variables with the first column a vector of 1s in order to estimate the intercept. y is the continuous variable to be modeled<label for="tufte-sn-9" class="margin-toggle sidenote-number">9</label><input type="checkbox" id="tufte-sn-9" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">9</span> Type ?optim at the console for more detail.</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sqerrloss =<span class="st"> </span>function(beta, X, y){
  mu =<span class="st"> </span>X%*%beta
  <span class="kw">sum</span>((y-mu)^<span class="dv">2</span>)
}

<span class="co"># data setup</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
N =<span class="st"> </span><span class="dv">100</span>
X =<span class="st"> </span><span class="kw">cbind</span>(<span class="dv">1</span>, <span class="kw">rnorm</span>(N), <span class="kw">rnorm</span>(N))
beta =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, -.<span class="dv">5</span>, .<span class="dv">5</span>)
y =<span class="st">  </span><span class="kw">rnorm</span>(N, X%*%beta, <span class="dt">sd=</span><span class="dv">1</span>)

<span class="co"># results</span>
our_func =<span class="st"> </span><span class="kw">optim</span>(<span class="dt">par=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">fn=</span>sqerrloss, <span class="dt">X=</span>X, <span class="dt">y=</span>y, <span class="dt">method=</span><span class="st">&#39;BFGS&#39;</span>)
lm_result =<span class="st"> </span><span class="kw">lm</span>(y ~<span class="st"> </span>., <span class="kw">data.frame</span>(X[,-<span class="dv">1</span>]))  <span class="co"># check with lm </span>
<span class="kw">rbind</span>(<span class="kw">c</span>(our_func$par, our_func$value), <span class="kw">c</span>(<span class="kw">coef</span>(lm_result), <span class="kw">sum</span>(<span class="kw">resid</span>(lm_result)^<span class="dv">2</span>)))</code></pre></div>
<pre><code>     (Intercept)         X1        X2         
[1,]   0.1350654 -0.6331715 0.5238113 87.78187
[2,]   0.1350654 -0.6331715 0.5238113 87.78187</code></pre>
</div>
</div>
<div id="categorical-outcomes" class="section level2">
<h2>Categorical Outcomes</h2>
<p>Here we’ll also look at some loss functions useful in classification problems. Note that there is not necessary exclusion in loss functions for continuous vs. categorical outcomes<label for="tufte-sn-10" class="margin-toggle sidenote-number">10</label><input type="checkbox" id="tufte-sn-10" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">10</span> For example, if dealing with probabilities, we technically could use minimize squared errors in the case of classification also. We could use a maximum likelihood for either setting (or minimize the negative log likelihood to turn it into a loss function).</span>. Generally though we’ll have different options.</p>
<div id="misclassification" class="section level3">
<h3>Misclassification</h3>
<p>Probably the most straightforward is misclassification, or 0-1 loss. If we note <span class="math inline">\(f\)</span> as the prediction, and for convenience we assume a [-1,1] response instead of a [0,1] response:</p>
<p><span class="math display">\[L(Y, f(X)) = \sum I(y\neq \mathrm{sign}(f))\]</span></p>
<p>In the above, <span class="math inline">\(I\)</span> is the indicator function, and so we are simply summing misclassifications.</p>
</div>
<div id="binomial-log-likelihood" class="section level3">
<h3>Binomial log-likelihood</h3>
<p><span class="math display">\[L(Y, f(X)) = \sum log(1 + e^{-2yf})\]</span></p>
<p>The above is in deviance form<span class="marginnote">Deviance can conceptually be thought of as the GLM version of residual variance.</span>, but is equivalent to binomial log likelihood if <span class="math inline">\(y\)</span> is on the 0-1 scale.</p>
</div>
<div id="exponential" class="section level3">
<h3>Exponential</h3>
<p>Exponential loss is yet another loss function at our disposal.</p>
<p><span class="math display">\[L(Y, f(X)) = \sum e^{-yf}\]</span></p>
</div>
<div id="hinge-loss" class="section level3">
<h3>Hinge Loss</h3>
<p>A final loss function to consider, typically used with support vector machines, is the hinge loss function.</p>
<p><span class="math display">\[L(Y, f(X)) = \max(1-yf, 0)\]</span></p>
<p>Here negative values of <span class="math inline">\(yf\)</span> are misclassifications, and so correct classifications do not contribute to the loss. We could also note it as <span class="math inline">\(\sum (1-yf)_+\)</span> , i.e. summing only those positive values of <span class="math inline">\(1-yf\)</span>.</p>
<p><span class="marginnote"><img src="img/lossfuncs.png" style="display:block; margin: 0 auto;"></span></p>
<p>Which of these might work best may be specific to the situation, but the gist is that they penalize negative values (misclassifications) more heavily and increasingly so the worse the misclassification (except for misclassification error, which penalizes all misclassifications equally), with their primary difference in how heavy that penalty is. At right is a depiction of the loss as a functions above, taken from <span class="citation">Hastie, Tibshirani, and Friedman (<label for="tufte-mn-5" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-5" class="margin-toggle">2009<span class="marginnote">Hastie, Trevor, Robert Tibshirani, and Jerome Friedman. 2009. <em>The Elements of Statistical Learning: Data Mining, Inference, and Prediction, Second Edition</em>. 2nd ed. 2009. Corr. 10th Printing. Springer.</span>)</span>.</p>

</div>
</div>
</div>
<p style="text-align: center;">
<a href="02_tools.html"><button class="btn btn-default">Previous</button></a>
<a href="04_regularization.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
